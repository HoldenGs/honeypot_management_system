#!/usr/bin/python3
"""
Module to map malware file objects to the postgres db.
"""
from sqlalchemy import Column, Integer, String, ForeignKey, DateTime, JSON
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.dialects import postgresql
from models.base import BaseModel, Base
from ipwhois import IPWhois
import datetime

class MalwareFile(BaseModel, Base):
    """
    Class for malware files
    """
    __tablename__ = 'malware_files'
    file_id = Column(Integer, primary_key=True, autoincrement=True)
    file_name = Column(String)
    file_md5 = Column(String)
    first_seen = Column(DateTime)
    last_seen = Column(DateTime)
    count = Column(Integer)
    alternative_names = Column(JSON)

    def __init__(self, file_name, file_md5):
        self.file_name = file_name
        self.file_md5 = file_md5
        self.first_seen = datetime.datetime.utcnow()
        self.last_seen = datetime.datetime.utcnow()
        self.count = 1
        self.alternative_names = json.dumps([])
